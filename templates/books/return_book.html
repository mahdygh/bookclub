{% extends 'base.html' %}
{% load static %}

{% block title %}Ø¨Ø§Ø²Ú¯Ø´Øª Ú©ØªØ§Ø¨{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <div class="hero-section text-center mb-4">
                <h1 class="display-4 fw-bold text-primary">Ø¨Ø§Ø²Ú¯Ø´Øª Ú©ØªØ§Ø¨</h1>
                <p class="lead">Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ø§Ø²Ú¯Ø´Øª Ú©ØªØ§Ø¨â€ŒÙ‡Ø§ Ùˆ Ø«Ø¨Øª Ø§Ù…ØªÛŒØ§Ø²Ø§Øª</p>
            </div>
        </div>
    </div>

    <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…Ù‡Ù… -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="alert alert-info">
                <h5><i class="fas fa-info-circle me-2"></i>Ù†Ú©ØªÙ‡ Ù…Ù‡Ù…</h5>
                <p class="mb-0">Ø¨Ø§Ø²Ú¯Ø´Øª Ú©ØªØ§Ø¨â€ŒÙ‡Ø§ Ùˆ Ø«Ø¨Øª Ø§Ù…ØªÛŒØ§Ø²Ø§Øª Ø§Ø² Ø·Ø±ÛŒÙ‚ <strong>Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ†</strong> Ø§Ù†Ø¬Ø§Ù… Ù…ÛŒâ€ŒØ´ÙˆØ¯. Ø¯Ø± Ø§ÛŒÙ† ØµÙØ­Ù‡ Ù…ÛŒâ€ŒØªÙˆØ§Ù†ÛŒØ¯ Ù„ÛŒØ³Øª Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„ Ø±Ø§ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</p>
            </div>
        </div>
    </div>

    <!-- Ø¢Ù…Ø§Ø± Ú©Ù„ÛŒ -->
    <div class="row mb-4">
        <div class="col-md-4">
            <div class="card stats-card text-center">
                <div class="card-body">
                    <h5 class="card-title">Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„</h5>
                    <h3 class="text-warning">{{ active_assignments.count }}</h3>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card stats-card text-center">
                <div class="card-body">
                    <h5 class="card-title">Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡</h5>
                    <h3 class="text-success">{{ completed_assignments.count }}</h3>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="card stats-card text-center">
                <div class="card-body">
                    <h5 class="card-title">Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§ÛŒ Ø¯ÛŒØ± Ø´Ø¯Ù‡</h5>
                    <h3 class="text-danger">{{ overdue_assignments.count }}</h3>
                </div>
            </div>
        </div>
    </div>

    <!-- Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„ -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§ÛŒ ÙØ¹Ø§Ù„</h5>
                </div>
                <div class="card-body">
                    {% if active_assignments %}
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Ø¹Ø¶Ùˆ</th>
                                        <th>Ú©ØªØ§Ø¨</th>
                                        <th>ØªØ§Ø±ÛŒØ® Ø§Ù…Ø§Ù†Øª Ú¯Ø±ÙØªÙ†</th>
                                        <th>ØªØ§Ø±ÛŒØ® Ù…ÙˆØ¹Ø¯</th>
                                        <th>ÙˆØ¶Ø¹ÛŒØª</th>
                                        <th>Ø¹Ù…Ù„ÛŒØ§Øª</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for assignment in active_assignments %}
                                        <tr>
                                            <td>
                                                <strong>{{ assignment.member.full_name }}</strong>
                                            </td>
                                            <td>
                                                <div>
                                                    <strong>{{ assignment.book.title }}</strong>
                                                    <br>
                                                    <small class="text-muted">{{ assignment.book.author }}</small>
                                                </div>
                                            </td>
                                            <td>
                                                <span class="text-primary">{{ assignment.assigned_date|date:"Y/m/d" }}</span>
                                            </td>
                                            <td>
                                                {% if assignment.due_date < today %}
                                                    <span class="text-danger fw-bold">{{ assignment.due_date|date:"Y/m/d" }}</span>
                                                {% else %}
                                                    <span class="text-success">{{ assignment.due_date|date:"Y/m/d" }}</span>
                                                {% endif %}
                                            </td>
                                            <td>
                                                {% if assignment.due_date < today %}
                                                    <span class="badge bg-danger">âš  Ø¯ÛŒØ± Ø´Ø¯Ù‡</span>
                                                {% else %}
                                                    <span class="badge bg-warning">ğŸ“– Ø¯Ø± Ø­Ø§Ù„ Ù…Ø·Ø§Ù„Ø¹Ù‡</span>
                                                {% endif %}
                                            </td>
                                            <td>
                                                <a href="{% url 'admin:books_bookassignment_change' assignment.id %}" class="btn btn-sm btn-outline-primary">
                                                    <i class="fas fa-edit me-1"></i>ÙˆÛŒØ±Ø§ÛŒØ´
                                                </a>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-book fa-3x text-muted mb-3"></i>
                            <p class="text-muted">Ù‡ÛŒÚ† Ø§Ù…Ø§Ù†Øª ÙØ¹Ø§Ù„ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡ -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§ÛŒ ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡</h5>
                </div>
                <div class="card-body">
                    {% if completed_assignments %}
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Ø¹Ø¶Ùˆ</th>
                                        <th>Ú©ØªØ§Ø¨</th>
                                        <th>ØªØ§Ø±ÛŒØ® Ø¨Ø§Ø²Ú¯Ø´Øª</th>
                                        <th>Ø§Ù…ØªÛŒØ§Ø² Ù…Ø·Ø§Ù„Ø¹Ù‡</th>
                                        <th>Ø§Ù…ØªÛŒØ§Ø² Ø¢Ø²Ù…ÙˆÙ†</th>
                                        <th>Ù…Ø¬Ù…ÙˆØ¹</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for assignment in completed_assignments %}
                                        <tr>
                                            <td>
                                                <strong>{{ assignment.member.full_name }}</strong>
                                            </td>
                                            <td>
                                                <div>
                                                    <strong>{{ assignment.book.title }}</strong>
                                                    <br>
                                                    <small class="text-muted">{{ assignment.book.author }}</small>
                                                </div>
                                            </td>
                                            <td>
                                                <span class="text-success">{{ assignment.returned_date|date:"Y/m/d" }}</span>
                                            </td>
                                            <td>
                                                <span class="badge bg-primary">{{ assignment.reading_score_earned }}</span>
                                            </td>
                                            <td>
                                                <span class="badge bg-info">{{ assignment.quiz_score_earned }}</span>
                                            </td>
                                            <td>
                                                <span class="fw-bold text-success">{{ assignment.reading_score_earned|add:assignment.quiz_score_earned }}</span>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-check-circle fa-3x text-muted mb-3"></i>
                            <p class="text-muted">Ù‡ÛŒÚ† Ø§Ù…Ø§Ù†Øª ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯Ù‡â€ŒØ§ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¹Ù…Ù„ÛŒØ§Øª -->
    <div class="row mt-4">
        <div class="col-12 text-center">
            <a href="{% url 'admin:books_bookassignment_changelist' %}" class="btn btn-primary btn-lg me-3">
                <i class="fas fa-list me-2"></i>Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù‡Ù…Ù‡ Ø§Ù…Ø§Ù†Øªâ€ŒÙ‡Ø§
            </a>
            <a href="{% url 'admin:index' %}" class="btn btn-success btn-lg">
                <i class="fas fa-cog me-2"></i>Ù¾Ù†Ù„ Ø§Ø¯Ù…ÛŒÙ†
            </a>
        </div>
    </div>
</div>
{% endblock %}
